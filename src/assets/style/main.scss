@mixin card-size($scale) {
  width: ($scale * 8) + vw;
  height: ($scale * 11.3) + vw;
  @media (min-width: 0px) and (max-width: 594px) {
    width: ($scale * 1.65 * 8) + vw;
    height: ($scale * 1.65 * 11.3) + vw;
  }
  @media (min-width: 595px) and (max-width: 768px) {
    width: ($scale * 1.65 * 8) + vw;
    height: ($scale * 1.65 * 11.3) + vw;
  }
  @media (min-width: 769px) and (max-width: 920px) {
    width: ($scale * 1.54 * 8) + vw;
    height: ($scale * 1.54 * 11.3) + vw;
  }
  @media (min-width: 921px) {
    width: ($scale * 0.78 * 8) + vw;
    height: ($scale * 0.78 * 11.3) + vw;
  }
}

@mixin card-gap {
  @media (min-width: 0px) and (max-width: 594px) {
    gap: 0.2rem;
  }
  @media (min-width: 595px) and (max-width: 768px) {
    gap: 0.5rem;
  }
  @media (min-width: 769px) and (max-width: 920px) {
    gap: 1rem;
  }
  @media (min-width: 921px) {
    gap: 2rem;
  }
}

@mixin top-down-gap {
  @media (min-width: 0px) and (max-width: 368px) {
    gap: 2rem;
  }
  @media (min-width: 367px) and (max-width: 594px) {
    gap: 3rem;
  }
  @media (min-width: 595px) and (max-width: 768px) {
    gap: 3rem;
  }
  @media (min-width: 769px) and (max-width: 920px) {
    gap: 4rem;
  }
  @media (min-width: 921px) {
    gap: 4rem;
  }
}

@mixin select-card-style {
  box-shadow: 0 0 1rem 0.1rem #22e37fc4;
}

@mixin card-parent {
  position: relative;
}

@mixin card-style {
  position: absolute;
  background-color: #ffffff;
  font-size: 2rem;

  @media (max-width: 768px) {
    font-size: 0.7rem;
  }
}

@mixin card-image-size {
  background-position: center center;
  background-size: cover;
  background-repeat: no-repeat;
}

@mixin transition($time) {
  transition: $time + ms ease-in-out;
  -webkit-transition: $time + ms ease-in-out;
  -moz-transition: $time + ms ease-in-out;
  -ms-transition: $time + ms ease-in-out;
  -o-transition: $time + ms ease-in-out;
}

@mixin transform-center-x($x) {
  transform: translateX($x);
  -webkit-transform: translateX($x);
  -moz-transform: translateX($x);
  -ms-transform: translateX($x);
  -o-transform: translateX($x);
}
@mixin transform-center-y($y) {
  transform: translateY($y);
  -webkit-transform: translateY($y);
  -moz-transform: translateY($y);
  -ms-transform: translateY($y);
  -o-transform: translateY($y);
}

@mixin transform-center($x, $y) {
  transform: translate($x, $y);
  -webkit-transform: translate($x, $y);
  -moz-transform: translate($x, $y);
  -ms-transform: translate($x, $y);
  -o-transform: translate($x, $y);
}

@mixin transform-rotate($deg) {
  transform: rotate($deg);
  -webkit-transform: rotate($deg);
  -moz-transform: rotate($deg);
  -ms-transform: rotate($deg);
  -o-transform: rotate($deg);
}

@mixin transform-unset() {
  transform: unset;
  -webkit-transform: unset;
  -moz-transform: unset;
  -ms-transform: unset;
  -o-transform: unset;
}

@mixin transform-scale($scale) {
  transform: scale($scale);
  -webkit-transform: scale($scale);
  -moz-transform: scale($scale);
  -ms-transform: scale($scale);
  -o-transform: scale($scale);
}

@mixin border-radius($radius) {
  @media (min-width: 0px) and (max-width: 594px) {
    border-radius: $radius * 1.35 + rem;
    -webkit-border-radius: $radius * 0.35 + rem;
    -moz-border-radius: $radius * 0.35 + rem;
    -ms-border-radius: $radius * 0.35 + rem;
    -o-border-radius: $radius * 0.35 + rem;
  }
  @media (min-width: 595px) and (max-width: 768px) {
    border-radius: $radius * 0.85 + rem;
    -webkit-border-radius: $radius * 0.85 + rem;
    -moz-border-radius: $radius * 0.85 + rem;
    -ms-border-radius: $radius * 0.85 + rem;
    -o-border-radius: $radius * 0.85 + rem;
  }

  @media (min-width: 769px) and (max-width: 920px) {
    border-radius: $radius * 0.65 + rem;
    -webkit-border-radius: $radius * 0.85 + rem;
    -moz-border-radius: $radius * 0.85 + rem;
    -ms-border-radius: $radius * 0.85 + rem;
    -o-border-radius: $radius * 0.85 + rem;
  }

  @media (min-width: 921px) {
    border-radius: $radius * 0.95 + rem;
    -webkit-border-radius: $radius * 0.95 + rem;
    -moz-border-radius: $radius * 0.95 + rem;
    -ms-border-radius: $radius * 0.95 + rem;
    -o-border-radius: $radius * 0.95 + rem;
  }
}

html,
body {
  overflow: hidden;
  height: 100vh;
  margin: 0;
}

body {
  position: relative;
  background-image: url("/images/background1.jpg");
  background-repeat: no-repeat;
  background-position: center center;
  background-size: cover;

  #app {
    #options {
      display: flex;
      justify-content: center;
      // text-align: center;
      margin-top: 1rem;
      gap: 1rem;

      .shape {
        background-color: #ffffff56;
        padding: 0.3rem 0.8rem;

        @include border-radius(0.3);
      }

      #timer {
        display: inline-block;
        text-align: center;
        &::before {
          content: "TIME";
          display: block;
          font-weight: 700;
        }
      }
      #score {
        text-align: center;
        &::before {
          content: "SCORE";
          display: block;
          font-weight: 700;
        }
        &::after {
          content: attr(data-game-score);
        }
      }
      #move {
        text-align: center;
        &::before {
          content: "MOVE";
          display: block;
          font-weight: 700;
        }
        &::after {
          content: attr(data-game-move);
        }
      }
    }

    #auto-complete,
    #restart {
      &:active {
        filter: brightness(0.85);
        -webkit-filter: brightness(0.85);
      }
      cursor: pointer;
      user-select: none;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      padding: 1.2rem 0.8rem;
      position: fixed;

      font-weight: 700;
      font-size: 14px;
      color: white;
      border: none;

      @include border-radius(0.3);
      @include transition(150);
    }

    #restart {
      &:hover,
      &:focus-within {
        box-shadow: 0 0 0 0.3rem #348389a6;
      }
      background-color: #348389;
      bottom: 25px;
      right: 15px;
    }
    #auto-complete {
      &:hover,
      &:focus-within {
        box-shadow: 0 0 0 0.3rem #893489a6;
      }
      background-color: #893489;
      bottom: 25px;
      right: 150px;
    }

    #wrapper {
      margin-top: 1rem;
      user-select: none;
      display: flex;
      flex-direction: column;
      @include top-down-gap;

      #top {
        display: flex;
        justify-content: center;
        @include card-gap();

        #pick-deck {
          display: flex;
          @include card-gap();

          .gap {
            @include card-size(1);
          }

          #deck {
            position: relative;
            display: flex;

            @include card-parent;

            & .back.zero {
              &::before {
                content: "♻️";
                position: absolute;
                font-weight: 700;
                font-size: 4vw;
                color: white;
                top: 50%;
                left: 50%;
                z-index: 5;

                @include transform-center(-50%, -50%);
              }
              &::after {
                filter: brightness(0.65);
                -webkit-filter: brightness(0.65);
              }

              @include transform-rotate(-5deg);
            }

            &::after {
              content: attr(data-pick-len) "/" attr(data-store-len);
              position: absolute;
              right: 5px;
              bottom: 5px;
              z-index: 100;
              color: white;
              font-size: calc(0.5vw + 0.7vh);
              background-color: #00000096;
              padding: 0.2rem 0.4rem;
            }
          }

          #pick {
            display: flex;

            .card:last-child:hover {
              @include select-card-style();
            }
            .card:not(:last-child):hover {
              box-shadow: 0 0 1rem 0.2rem #00000056;
              @include transform-unset();
            }

            @include card-parent;
          }
        }

        #stack {
          display: flex;
          @include card-gap();
          @include card-parent;

          #diamond-stack,
          #heart-stack,
          #spade-stack,
          #clover-stack {
            position: relative;
          }
        }
      }

      #body {
        display: flex;
        flex: 1;
        min-height: 600px;

        #ground {
          display: flex;
          @include card-gap();
          justify-content: center;
          flex: 1;

          .column {
            @include card-parent;
            display: flex;
            flex-direction: column;
          }
        }
      }

      .card[data-card-open="true"] {
        box-shadow: 0 0 calc(0.5vw + 0.7vh) calc(0.2vw + 0.3vh) #00000026;
      }

      .back,
      .card,
      .empty {
        overflow: hidden;
        @include card-size(1);
        @include border-radius(0.5);
        @include card-image-size;
        @include transition(150);
      }

      .empty {
        box-shadow: inset 0 0 0 99999999999px #ffffff56;
      }

      .back,
      .card {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        @include card-style;
        z-index: 5;

        &:not([data-card-open="false"]):hover {
          @include select-card-style();
        }

        &:not([data-card-open="false"]).selected {
          @include select-card-style();
          &:last-child::after {
            content: "✅";
            text-shadow: 3px 3px 3px #55555556;
            position: absolute;
            top: 50%;
            left: 50%;
            font-size: 2rem;
            @include transform-center(-50%, -50%);
          }
        }

        & .card-top {
          display: flex;
          justify-content: space-around;
          padding-top: 0.2rem;
          font-size: 3vw;
        }
        & .card-mid {
          text-align: center;
          font-size: 7vw;
          @media (max-width: 568px) {
            display: none;
          }
        }
        & .card-bottom {
          display: flex;
          flex-direction: row-reverse;
          justify-content: space-around;
          padding-bottom: 0.2rem;
          font-size: 3vw;
        }
      }
    }

    [data-card-type="heart"],
    [data-card-type="diamond"] {
      color: red;
    }

    .back,
    [data-card-open="false"] {
      &::after {
        position: absolute;
        content: "";
        background-color: #03142e !important;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: url("/cards/back_0.png");
        @include card-image-size;
        @include border-radius(0.3);
      }
    }
  }
}
